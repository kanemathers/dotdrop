#!/bin/bash
# dotdrop
# =======
#
# Keep your dotfiles nsync with the dropbox as the backup dancer.
# https://github.com/kanemathers/dotdrop
#
# How to Install
# --------------
#
# Source this file in ~/.bash_profile::
#
#     $ echo "[ -f ~/Dropbox/dotdrop/dotdrop ] && source ~/Dropbox/dotdrop/dotdrop" >> ~/.bash_profile
#

[ -f ~/Dropbox/dotdrop/sync ] && . ~/Dropbox/dotdrop/sync

HERE=$(cd $(dirname "${BASH_SOURCE[0]}") && pwd -P)
DOTDROP_SLEEP=${DOTDROP_SLEEP:-10}

dotdrop_sync()
{
    remove_links

    # Sleep long enough for an internet connection to be established and,
    # hopefully, long enough for dropbox to sync the plugins.
    sleep $DOTDROP_SLEEP

    for plugin in "$HERE"/plugins.d/*/*; do
        create_link "$plugin"
    done
}

(dotdrop_sync &)
